{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///D:/banner-schedule-slack/banner-schedule-web/src/app/admin/page.js"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport * as XLSX from \"xlsx\";\r\n\r\nconst BANNER_TYPES = {\r\n  home: \"üè† ÌôàÎ∞∞ÎÑà\",\r\n  floating: \"üìå ÌîåÎ°úÌåÖÎ∞∞ÎÑà\",\r\n  interest: \"‚≠ê Í¥ÄÏã¨Í∑∏Î£πÌÉ≠Î∞∞ÎÑà\",\r\n};\r\n\r\nfunction getCurrentMonthYYYYMM() {\r\n  const d = new Date();\r\n  return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, \"0\")}`;\r\n}\r\n\r\nfunction safeString(v) {\r\n  return typeof v === \"string\" ? v : v == null ? \"\" : String(v);\r\n}\r\n\r\nexport default function AdminPage() {\r\n  const [month, setMonth] = useState(getCurrentMonthYYYYMM());\r\n  const [activeType, setActiveType] = useState(\"home\");\r\n  const [allData, setAllData] = useState({\r\n    home: [],\r\n    floating: [],\r\n    interest: [],\r\n  });\r\n  const [loadError, setLoadError] = useState(\"\");\r\n\r\n  /* ===============================\r\n   * 3Ï¢ÖÎ•ò Îç∞Ïù¥ÌÑ∞ Î™®Îëê Î°úÎìú\r\n   * =============================== */\r\n  useEffect(() => {\r\n    async function run() {\r\n      try {\r\n        setLoadError(\"\");\r\n\r\n        const results = {};\r\n\r\n        for (const type of Object.keys(BANNER_TYPES)) {\r\n          const res = await fetch(\r\n            `http://localhost:3000/api/banner/${type}`,\r\n            { cache: \"no-store\" }\r\n          );\r\n\r\n          if (!res.ok) {\r\n            throw new Error(`${type} API Ïã§Ìå®`);\r\n          }\r\n\r\n          results[type] = await res.json();\r\n        }\r\n\r\n        setAllData(results);\r\n      } catch (e) {\r\n        setLoadError(e?.message || \"Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®\");\r\n      }\r\n    }\r\n\r\n    run();\r\n  }, []);\r\n\r\n  /* ===============================\r\n   * Ïõî ÌïÑÌÑ∞\r\n   * =============================== */\r\n  const filtered = useMemo(() => {\r\n    const raw = allData[activeType] || [];\r\n\r\n    return raw\r\n      .filter((item) =>\r\n        safeString(item.startDate).startsWith(month)\r\n      )\r\n      .sort((a, b) => {\r\n        const aStart = safeString(a.startDate);\r\n        const bStart = safeString(b.startDate);\r\n        if (aStart !== bStart) return aStart.localeCompare(bStart);\r\n\r\n        return safeString(a.createdAt).localeCompare(\r\n          safeString(b.createdAt)\r\n        );\r\n      })\r\n      .map((item, idx) => ({\r\n        no: idx + 1,\r\n        ...item,\r\n      }));\r\n  }, [allData, activeType, month]);\r\n\r\n  /* ===============================\r\n   * ÏóëÏÖÄ 3ÏãúÌä∏ Îã§Ïö¥Î°úÎìú\r\n   * =============================== */\r\n  function downloadExcel() {\r\n    const wb = XLSX.utils.book_new();\r\n\r\n    Object.keys(BANNER_TYPES).forEach((type) => {\r\n      const rows = (allData[type] || [])\r\n        .filter((item) =>\r\n          safeString(item.startDate).startsWith(month)\r\n        )\r\n        .map((item, idx) => ({\r\n          No: idx + 1,\r\n          department: safeString(item.department),\r\n          manager: safeString(item.manager),\r\n          banner: safeString(item.banner),\r\n          startDate: safeString(item.startDate),\r\n          endDate: safeString(item.endDate),\r\n          createdAt: safeString(item.createdAt),\r\n        }));\r\n\r\n      const ws = XLSX.utils.json_to_sheet(rows);\r\n      XLSX.utils.book_append_sheet(wb, ws, BANNER_TYPES[type]);\r\n    });\r\n\r\n    XLSX.writeFile(wb, `banner_admin_${month}.xlsx`);\r\n  }\r\n\r\n  return (\r\n    <main style={{ padding: 40, fontFamily: \"sans-serif\" }}>\r\n      <h1 style={{ fontSize: 26, marginBottom: 20 }}>\r\n        üõ† Î∞∞ÎÑà Í¥ÄÎ¶¨Ïûê ÌôîÎ©¥\r\n      </h1>\r\n\r\n      {/* ÌÉ≠ Î≤ÑÌäº */}\r\n      <div style={{ display: \"flex\", gap: 10, marginBottom: 20 }}>\r\n        {Object.entries(BANNER_TYPES).map(([type, label]) => (\r\n          <button\r\n            key={type}\r\n            onClick={() => setActiveType(type)}\r\n            style={{\r\n              padding: \"8px 14px\",\r\n              cursor: \"pointer\",\r\n              background:\r\n                activeType === type ? \"#222\" : \"#eee\",\r\n              color:\r\n                activeType === type ? \"#fff\" : \"#000\",\r\n              border: \"none\",\r\n              borderRadius: 6,\r\n            }}\r\n          >\r\n            {label}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Ïª®Ìä∏Î°§ */}\r\n      <div style={{ display: \"flex\", gap: 12, marginBottom: 16 }}>\r\n        <input\r\n          type=\"month\"\r\n          value={month}\r\n          onChange={(e) => setMonth(e.target.value)}\r\n        />\r\n\r\n        <button\r\n          onClick={downloadExcel}\r\n          style={{ padding: \"6px 10px\" }}\r\n        >\r\n          ‚¨á 3Ï¢Ö ÏóëÏÖÄ Îã§Ïö¥Î°úÎìú\r\n        </button>\r\n\r\n        <span style={{ color: \"#666\" }}>\r\n          ({filtered.length}Í±¥)\r\n        </span>\r\n      </div>\r\n\r\n      {/* ÏóêÎü¨ */}\r\n      {loadError && (\r\n        <div style={{ color: \"red\", marginBottom: 16 }}>\r\n          ‚ùå {loadError}\r\n        </div>\r\n      )}\r\n\r\n      {/* ÌÖåÏù¥Î∏î */}\r\n      <table\r\n        border=\"1\"\r\n        cellPadding=\"8\"\r\n        style={{\r\n          borderCollapse: \"collapse\",\r\n          width: \"100%\",\r\n          textAlign: \"center\",\r\n        }}\r\n      >\r\n        <thead style={{ background: \"#f3f3f3\" }}>\r\n          <tr>\r\n            <th>No</th>\r\n            <th>Department</th>\r\n            <th>Manager</th>\r\n            <th>Banner</th>\r\n            <th>StartDate</th>\r\n            <th>EndDate</th>\r\n            <th>CreatedAt</th>\r\n          </tr>\r\n        </thead>\r\n\r\n        <tbody>\r\n          {filtered.length === 0 ? (\r\n            <tr>\r\n              <td colSpan=\"7\">Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå</td>\r\n            </tr>\r\n          ) : (\r\n            filtered.map((item) => (\r\n              <tr key={safeString(item.id) || item.no}>\r\n                <td>{item.no}</td>\r\n                <td>{safeString(item.department)}</td>\r\n                <td>{safeString(item.manager)}</td>\r\n                <td>{safeString(item.banner)}</td>\r\n                <td>{safeString(item.startDate)}</td>\r\n                <td>{safeString(item.endDate)}</td>\r\n                <td>{safeString(item.createdAt)}</td>\r\n              </tr>\r\n            ))\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}