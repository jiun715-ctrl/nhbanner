{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["D:/banner-schedule-slack/banner-schedule-web/src/app/admin/page.js"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport * as XLSX from \"xlsx\";\r\n\r\nconst BANNER_TYPES = {\r\n  home: \"üè† ÌôàÎ∞∞ÎÑà\",\r\n  floating: \"üìå ÌîåÎ°úÌåÖÎ∞∞ÎÑà\",\r\n  interest: \"‚≠ê Í¥ÄÏã¨Í∑∏Î£πÌÉ≠Î∞∞ÎÑà\",\r\n};\r\n\r\nfunction getCurrentMonthYYYYMM() {\r\n  const d = new Date();\r\n  return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, \"0\")}`;\r\n}\r\n\r\nfunction safeString(v) {\r\n  return typeof v === \"string\" ? v : v == null ? \"\" : String(v);\r\n}\r\n\r\nexport default function AdminPage() {\r\n  const [month, setMonth] = useState(getCurrentMonthYYYYMM());\r\n  const [activeType, setActiveType] = useState(\"home\");\r\n  const [allData, setAllData] = useState({\r\n    home: [],\r\n    floating: [],\r\n    interest: [],\r\n  });\r\n  const [loadError, setLoadError] = useState(\"\");\r\n\r\n  /* ===============================\r\n   * 3Ï¢ÖÎ•ò Îç∞Ïù¥ÌÑ∞ Î™®Îëê Î°úÎìú\r\n   * =============================== */\r\n  useEffect(() => {\r\n    async function run() {\r\n      try {\r\n        setLoadError(\"\");\r\n\r\n        const results = {};\r\n\r\n        for (const type of Object.keys(BANNER_TYPES)) {\r\n          const res = await fetch(\r\n            `http://localhost:3000/api/banner/${type}`,\r\n            { cache: \"no-store\" }\r\n          );\r\n\r\n          if (!res.ok) {\r\n            throw new Error(`${type} API Ïã§Ìå®`);\r\n          }\r\n\r\n          results[type] = await res.json();\r\n        }\r\n\r\n        setAllData(results);\r\n      } catch (e) {\r\n        setLoadError(e?.message || \"Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®\");\r\n      }\r\n    }\r\n\r\n    run();\r\n  }, []);\r\n\r\n  /* ===============================\r\n   * Ïõî ÌïÑÌÑ∞\r\n   * =============================== */\r\n  const filtered = useMemo(() => {\r\n    const raw = allData[activeType] || [];\r\n\r\n    return raw\r\n      .filter((item) =>\r\n        safeString(item.startDate).startsWith(month)\r\n      )\r\n      .sort((a, b) => {\r\n        const aStart = safeString(a.startDate);\r\n        const bStart = safeString(b.startDate);\r\n        if (aStart !== bStart) return aStart.localeCompare(bStart);\r\n\r\n        return safeString(a.createdAt).localeCompare(\r\n          safeString(b.createdAt)\r\n        );\r\n      })\r\n      .map((item, idx) => ({\r\n        no: idx + 1,\r\n        ...item,\r\n      }));\r\n  }, [allData, activeType, month]);\r\n\r\n  /* ===============================\r\n   * ÏóëÏÖÄ 3ÏãúÌä∏ Îã§Ïö¥Î°úÎìú\r\n   * =============================== */\r\n  function downloadExcel() {\r\n    const wb = XLSX.utils.book_new();\r\n\r\n    Object.keys(BANNER_TYPES).forEach((type) => {\r\n      const rows = (allData[type] || [])\r\n        .filter((item) =>\r\n          safeString(item.startDate).startsWith(month)\r\n        )\r\n        .map((item, idx) => ({\r\n          No: idx + 1,\r\n          department: safeString(item.department),\r\n          manager: safeString(item.manager),\r\n          banner: safeString(item.banner),\r\n          startDate: safeString(item.startDate),\r\n          endDate: safeString(item.endDate),\r\n          createdAt: safeString(item.createdAt),\r\n        }));\r\n\r\n      const ws = XLSX.utils.json_to_sheet(rows);\r\n      XLSX.utils.book_append_sheet(wb, ws, BANNER_TYPES[type]);\r\n    });\r\n\r\n    XLSX.writeFile(wb, `banner_admin_${month}.xlsx`);\r\n  }\r\n\r\n  return (\r\n    <main style={{ padding: 40, fontFamily: \"sans-serif\" }}>\r\n      <h1 style={{ fontSize: 26, marginBottom: 20 }}>\r\n        üõ† Î∞∞ÎÑà Í¥ÄÎ¶¨Ïûê ÌôîÎ©¥\r\n      </h1>\r\n\r\n      {/* ÌÉ≠ Î≤ÑÌäº */}\r\n      <div style={{ display: \"flex\", gap: 10, marginBottom: 20 }}>\r\n        {Object.entries(BANNER_TYPES).map(([type, label]) => (\r\n          <button\r\n            key={type}\r\n            onClick={() => setActiveType(type)}\r\n            style={{\r\n              padding: \"8px 14px\",\r\n              cursor: \"pointer\",\r\n              background:\r\n                activeType === type ? \"#222\" : \"#eee\",\r\n              color:\r\n                activeType === type ? \"#fff\" : \"#000\",\r\n              border: \"none\",\r\n              borderRadius: 6,\r\n            }}\r\n          >\r\n            {label}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Ïª®Ìä∏Î°§ */}\r\n      <div style={{ display: \"flex\", gap: 12, marginBottom: 16 }}>\r\n        <input\r\n          type=\"month\"\r\n          value={month}\r\n          onChange={(e) => setMonth(e.target.value)}\r\n        />\r\n\r\n        <button\r\n          onClick={downloadExcel}\r\n          style={{ padding: \"6px 10px\" }}\r\n        >\r\n          ‚¨á 3Ï¢Ö ÏóëÏÖÄ Îã§Ïö¥Î°úÎìú\r\n        </button>\r\n\r\n        <span style={{ color: \"#666\" }}>\r\n          ({filtered.length}Í±¥)\r\n        </span>\r\n      </div>\r\n\r\n      {/* ÏóêÎü¨ */}\r\n      {loadError && (\r\n        <div style={{ color: \"red\", marginBottom: 16 }}>\r\n          ‚ùå {loadError}\r\n        </div>\r\n      )}\r\n\r\n      {/* ÌÖåÏù¥Î∏î */}\r\n      <table\r\n        border=\"1\"\r\n        cellPadding=\"8\"\r\n        style={{\r\n          borderCollapse: \"collapse\",\r\n          width: \"100%\",\r\n          textAlign: \"center\",\r\n        }}\r\n      >\r\n        <thead style={{ background: \"#f3f3f3\" }}>\r\n          <tr>\r\n            <th>No</th>\r\n            <th>Department</th>\r\n            <th>Manager</th>\r\n            <th>Banner</th>\r\n            <th>StartDate</th>\r\n            <th>EndDate</th>\r\n            <th>CreatedAt</th>\r\n          </tr>\r\n        </thead>\r\n\r\n        <tbody>\r\n          {filtered.length === 0 ? (\r\n            <tr>\r\n              <td colSpan=\"7\">Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå</td>\r\n            </tr>\r\n          ) : (\r\n            filtered.map((item) => (\r\n              <tr key={safeString(item.id) || item.no}>\r\n                <td>{item.no}</td>\r\n                <td>{safeString(item.department)}</td>\r\n                <td>{safeString(item.manager)}</td>\r\n                <td>{safeString(item.banner)}</td>\r\n                <td>{safeString(item.startDate)}</td>\r\n                <td>{safeString(item.endDate)}</td>\r\n                <td>{safeString(item.createdAt)}</td>\r\n              </tr>\r\n            ))\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </main>\r\n  );\r\n}\r\n"],"names":["useEffect","useMemo","useState","XLSX","BANNER_TYPES","home","floating","interest","getCurrentMonthYYYYMM","d","Date","getFullYear","String","getMonth","padStart","safeString","v","AdminPage","month","setMonth","activeType","setActiveType","allData","setAllData","loadError","setLoadError","run","results","type","Object","keys","res","fetch","cache","ok","Error","json","e","message","filtered","raw","filter","item","startDate","startsWith","sort","a","b","aStart","bStart","localeCompare","createdAt","map","idx","no","downloadExcel","wb","utils","book_new","forEach","rows","No","department","manager","banner","endDate","ws","json_to_sheet","book_append_sheet","writeFile","padding","fontFamily","fontSize","marginBottom","display","gap","entries","label","cursor","background","color","border","borderRadius","target","value","length","borderCollapse","width","textAlign","id"],"mappings":"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","ignoreList":[]}}]
}